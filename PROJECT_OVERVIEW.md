# 📊 Обзор проекта: Система учёта посещений тренажёрного зала

## 🎯 Цель проекта

Создать полнофункциональное веб-приложение для автоматизации учёта посещений тренажёрного зала с использованием QR-кодов.

---

## 🏗️ Архитектура системы

```
┌─────────────────────────────────────────────────────────────┐
│                     КЛИЕНТ (Браузер)                        │
│                                                             │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │
│  │   Админ      │  │   Сканер     │  │  Аналитика   │     │
│  │   панель     │  │   QR-кодов   │  │   и отчёты   │     │
│  └──────────────┘  └──────────────┘  └──────────────┘     │
│         │                  │                  │             │
└─────────┼──────────────────┼──────────────────┼─────────────┘
          │                  │                  │
          └──────────────────┴──────────────────┘
                             │
                    ┌────────▼────────┐
                    │   React App     │
                    │  (Frontend)     │
                    │  Port: 3000     │
                    └────────┬────────┘
                             │
                    ┌────────▼────────┐
                    │   Express API   │
                    │   (Backend)     │
                    │  Port: 3001     │
                    └────────┬────────┘
                             │
                    ┌────────▼────────┐
                    │  SQLite DB      │
                    │   (gym.db)      │
                    └─────────────────┘
```

---

## 📦 Модули системы

### 1️⃣ Модуль аутентификации
- **Вход в систему** с логином и паролем
- **JWT токены** для безопасности
- **Хеширование паролей** (bcrypt)

### 2️⃣ Модуль управления клиентами
- **CRUD операции** (создание, чтение, обновление, удаление)
- **Генерация QR-кодов** с UUID
- **Управление абонементами** (статус, дата окончания)
- **Привязка к тренерам**

### 3️⃣ Модуль управления тренерами
- **CRUD операции** для тренеров
- **Статистика** по клиентам
- **Специализации** тренеров

### 4️⃣ Модуль посещений
- **Сканирование QR-кодов** через камеру
- **Проверка абонемента** при входе
- **Регистрация посещения** с датой и временем
- **Журнал посещений** с фильтрами

### 5️⃣ Модуль аналитики
- **Общая статистика** (посещения, клиенты, абонементы)
- **Топ активных клиентов**
- **Статистика тренеров**
- **Графики и диаграммы**
- **Анализ пиковых часов**

---

## 🗄️ Структура базы данных

```sql
┌─────────────────┐
│     admins      │
├─────────────────┤
│ id              │ PK
│ username        │ UNIQUE
│ password        │ (hashed)
│ full_name       │
│ created_at      │
└─────────────────┘

┌─────────────────┐
│    trainers     │
├─────────────────┤
│ id              │ PK
│ uuid            │ UNIQUE
│ full_name       │
│ phone           │
│ specialization  │
│ created_at      │
└─────────────────┘
         │
         │ 1:N
         │
┌─────────────────┐
│    clients      │
├─────────────────┤
│ id              │ PK
│ uuid            │ UNIQUE (для QR)
│ full_name       │
│ phone           │
│ registration_date│
│ membership_active│ BOOLEAN
│ membership_end_date│
│ trainer_id      │ FK → trainers.id
│ created_at      │
└─────────────────┘
         │
         │ 1:N
         │
┌─────────────────┐
│     visits      │
├─────────────────┤
│ id              │ PK
│ client_id       │ FK → clients.id
│ visit_date      │ DATE
│ visit_time      │ TIME
│ created_at      │
└─────────────────┘
```

---

## 🔄 Процесс регистрации посещения

```
1. Клиент приходит в зал
         │
         ▼
2. Показывает QR-код на входе
         │
         ▼
3. Сканер считывает UUID из QR-кода
         │
         ▼
4. Система находит клиента по UUID
         │
         ▼
5. Проверяет статус абонемента
         │
    ┌────┴────┐
    │         │
    ▼         ▼
Активен   Неактивен
    │         │
    │         └──> ❌ Отказ в доступе
    │
    ▼
6. Проверяет дату окончания
    │
    ┌────┴────┐
    │         │
    ▼         ▼
Действует  Истёк
    │         │
    │         └──> ❌ Отказ в доступе
    │
    ▼
7. ✅ Регистрирует посещение
    │
    ▼
8. Показывает информацию о клиенте и тренере
```

---

## 🎨 Интерфейс пользователя

### Главная панель (Dashboard)
```
┌────────────────────────────────────────────────────┐
│  📊 Главная панель                                 │
├────────────────────────────────────────────────────┤
│                                                    │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────┐│
│  │ Всего    │ │ Уникал.  │ │ Активных │ │ %    ││
│  │ посещ.   │ │ посетит. │ │ абонем.  │ │ посещ││
│  │   150    │ │    45    │ │    60    │ │ 75%  ││
│  └──────────┘ └──────────┘ └──────────┘ └──────┘│
│                                                    │
│  ┌────────────────────────────────────────────┐   │
│  │      📈 График посещений по дням           │   │
│  │                                            │   │
│  │         ▁▃▅▇█▇▅▃▁                         │   │
│  └────────────────────────────────────────────┘   │
└────────────────────────────────────────────────────┘
```

### Управление клиентами
```
┌────────────────────────────────────────────────────┐
│  👥 Клиенты                    [+ Добавить клиента]│
├────────────────────────────────────────────────────┤
│                                                    │
│  ┌─────────────────────────────────────────────┐  │
│  │ ФИО          │ Телефон  │ Тренер │ Абонемент││
│  ├─────────────────────────────────────────────┤  │
│  │ Иванов И.И.  │ +7...    │ Петров │ ✅ Активен││
│  │ Сидоров С.С. │ +7...    │ —      │ ❌ Неактив││
│  │              │          │        │ [QR][✏️][🗑️]││
│  └─────────────────────────────────────────────┘  │
└────────────────────────────────────────────────────┘
```

### Сканер QR-кодов
```
┌────────────────────────────────────────────────────┐
│  📱 Сканер QR-кодов                                │
├────────────────────────────────────────────────────┤
│                                                    │
│  ┌────────────────────────────────────────────┐   │
│  │                                            │   │
│  │         📷 Камера активна                  │   │
│  │                                            │   │
│  │         ┌──────────────┐                   │   │
│  │         │              │                   │   │
│  │         │  Прицел для  │                   │   │
│  │         │  QR-кода     │                   │   │
│  │         │              │                   │   │
│  │         └──────────────┘                   │   │
│  │                                            │   │
│  └────────────────────────────────────────────┘   │
│                                                    │
│  или введите UUID вручную:                        │
│  ┌────────────────────────┐ [Проверить]           │
│  └────────────────────────┘                       │
└────────────────────────────────────────────────────┘
```

### Результат сканирования
```
┌────────────────────────────────────────────────────┐
│                                                    │
│              ✅ Успешно!                           │
│                                                    │
│  ┌────────────────────────────────────────────┐   │
│  │ Клиент: Иванов Иван Иванович              │   │
│  │ Телефон: +7 (999) 123-45-67               │   │
│  │ Тренер: Петров Пётр Петрович              │   │
│  │ Время: 14:30                               │   │
│  └────────────────────────────────────────────┘   │
│                                                    │
│  Посещение зарегистрировано!                      │
└────────────────────────────────────────────────────┘
```

---

## 🔐 Безопасность

### Уровни защиты:

1. **Аутентификация**
   - JWT токены с истечением срока действия
   - Хеширование паролей (bcrypt, 10 раундов)

2. **Авторизация**
   - Middleware проверки токенов на всех защищённых маршрутах
   - Разделение публичных и приватных API

3. **Данные**
   - QR-коды содержат только UUID (без персональных данных)
   - Валидация всех входных данных
   - Защита от SQL-инъекций (prepared statements)

4. **API**
   - CORS настроен для безопасности
   - Rate limiting (можно добавить)
   - HTTPS для продакшена

---

## 📈 Возможности расширения

### Будущие улучшения:

1. **Уведомления**
   - Email/SMS при истечении абонемента
   - Push-уведомления для клиентов

2. **Платежи**
   - Интеграция платёжных систем
   - Онлайн-продление абонементов

3. **Мобильное приложение**
   - iOS/Android приложение для клиентов
   - Просмотр истории посещений
   - Бронирование тренировок

4. **Расширенная аналитика**
   - Прогнозирование посещаемости
   - Рекомендации по загрузке зала
   - Анализ эффективности тренеров

5. **Интеграция**
   - Календарь тренировок
   - Система бронирования
   - CRM интеграция

---

## 🚀 Производительность

### Оптимизации:

- **База данных:**
  - Индексы на часто используемых полях (UUID, даты)
  - Prepared statements для быстрых запросов

- **Frontend:**
  - Code splitting с React Router
  - Lazy loading компонентов
  - Оптимизация изображений

- **Backend:**
  - Кэширование статических данных
  - Пул соединений к БД
  - Сжатие ответов (gzip)

---

## 📊 Метрики успеха

### KPI системы:

1. **Скорость регистрации посещения:** < 2 секунды
2. **Точность распознавания QR:** > 99%
3. **Доступность системы:** > 99.9%
4. **Время отклика API:** < 100ms
5. **Удовлетворённость пользователей:** > 4.5/5

---

## 🎓 Обучение персонала

### Необходимые навыки:

1. **Администратор:**
   - Добавление/редактирование клиентов
   - Управление тренерами
   - Просмотр аналитики
   - Генерация QR-кодов

2. **Сотрудник на входе:**
   - Использование сканера QR
   - Обработка отказов в доступе
   - Ручной ввод UUID

3. **Тренер:**
   - Просмотр своих клиентов
   - Отслеживание посещаемости

---

## 📞 Техническая поддержка

### Контакты:

- **Документация:** README.md, SETUP.md, SUMMARY.md
- **Быстрый старт:** QUICK_START.md
- **Установка:** ./install.sh

### Типичные проблемы:

1. **Не устанавливаются зависимости**
   → Установите Xcode Command Line Tools

2. **Камера не работает**
   → Разрешите доступ в браузере

3. **Порты заняты**
   → Измените порты в .env и vite.config.js

---

## ✅ Готовность к использованию

Проект **полностью готов** к развёртыванию и использованию!

### Что уже сделано:

- ✅ Backend API (Express + SQLite)
- ✅ Frontend (React + TailwindCSS)
- ✅ База данных с миграциями
- ✅ Аутентификация и безопасность
- ✅ QR-код генерация и сканирование
- ✅ Журнал посещений
- ✅ Аналитика и отчёты
- ✅ Адаптивный дизайн
- ✅ Документация

### Следующий шаг:

```bash
# Установите Xcode Command Line Tools
xcode-select --install

# Запустите автоматическую установку
./install.sh

# Запустите приложение
npm run dev
```

**Готово к работе! 🎉**
